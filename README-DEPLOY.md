# 剧本管理系统 - 部署指南

## 🚀 一键部署脚本使用说明

本项目提供了多个批处理脚本，方便您快速部署和管理剧本管理系统。

### 📁 脚本文件说明

| 脚本文件 | 功能描述 | 使用场景 |
|---------|---------|---------|
| `deploy.bat` | 完整部署脚本 | 首次部署或完整重新部署 |
| `quick-start.bat` | 快速启动脚本 | 日常启动服务 |
| `stop.bat` | 停止服务脚本 | 停止所有服务 |
| `restart.bat` | 重启服务脚本 | 重启所有服务 |

### 🔧 使用方法

#### 1. 首次部署
```bash
# 双击运行或在命令行执行
deploy.bat
```

**功能包括：**
- ✅ 检查Node.js环境
- ✅ 安装项目依赖
- ✅ 创建必要目录
- ✅ 构建前端项目
- ✅ 启动后端服务
- ✅ 启动前端服务
- ✅ 自动打开浏览器

#### 2. 日常启动
```bash
# 快速启动（跳过依赖安装和构建）
quick-start.bat
```

#### 3. 停止服务
```bash
# 停止所有服务
stop.bat
```

#### 4. 重启服务
```bash
# 重启所有服务
restart.bat
```

### 🌐 访问地址

部署成功后，您可以通过以下地址访问：

- **前端界面**: http://localhost:5173
- **后端API**: http://localhost:3001

### 👤 默认账号

系统提供以下默认账号：

| 角色 | 邮箱 | 说明 |
|------|------|------|
| 管理员 | admin@mm.com | 具有完整管理权限 |
| 普通用户 | user@example.com | 基础用户权限 |

> 💡 **提示**: 首次登录时，系统会自动创建这些账号，无需手动注册。

### 📂 目录结构

部署后会自动创建以下目录：

```
项目根目录/
├── uploads/          # 文件上传目录
│   ├── images/       # 剧本图片
│   └── json/         # 剧本JSON文件
├── data/             # 数据存储目录
│   ├── scripts.json  # 剧本数据
│   ├── users.json    # 用户数据
│   └── config.json   # 系统配置
├── logs/             # 日志目录
└── dist/             # 前端构建文件
```

### ⚠️ 注意事项

1. **端口占用**: 确保端口 3001 和 5173 未被其他程序占用
2. **Node.js版本**: 建议使用 Node.js 18.x 或更高版本
3. **防火墙**: 如需外网访问，请开放相应端口
4. **数据备份**: 定期备份 `data/` 和 `uploads/` 目录

### 🔧 故障排除

#### 问题1: 端口被占用
```bash
# 查看端口占用情况
netstat -ano | findstr :3001
netstat -ano | findstr :5173

# 结束占用进程
taskkill /PID <进程ID> /F
```

#### 问题2: 依赖安装失败
```bash
# 清理npm缓存
npm cache clean --force

# 删除node_modules重新安装
rmdir /s node_modules
npm install
```

#### 问题3: 前端构建失败
```bash
# 检查Node.js版本
node --version

# 更新依赖
npm update
```

### 📝 自定义配置

如需修改默认配置，请编辑以下文件：

- **端口配置**: `vite.config.ts` 和 `server.cjs`
- **数据库配置**: `data/config.json`
- **系统设置**: 通过管理后台界面修改

### 🚀 生产环境部署

对于生产环境，建议：

1. 使用 PM2 管理进程
2. 配置 Nginx 反向代理
3. 启用 HTTPS
4. 设置定时备份

详细的生产环境部署指南请参考 `deployment-guide-aliyun-windows.md`。

### 📞 技术支持

如遇到问题，请检查：

1. 控制台错误信息
2. 浏览器开发者工具
3. 后端服务日志
4. 系统事件日志

---

**祝您使用愉快！** 🎉